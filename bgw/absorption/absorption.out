
 BerkeleyGW version 3.0
 BSE/Absorption code, Complex version, run on 04-Jul-2023 at 06:28:16 -0700

                                                                 ..o.          
                                                                .oxxo.         
                                                               .oxxxxo...      
                                                               oxxxxxxo.       
                                                              .oxxxxxxx.       
                                                              .ooooooxxo..     
                                                              .oooooooxo..     
                                                              .oooooxxo...     
                                                       .........oxooo......    
                                                 ............................  
                                             ................................. 
                                          .................................... 
           .          ..oo. ....  .................................oooxxxxxxxo.
     .............oxxxx@ox@@@x@x.....................o...........ooooooooooxx. 
    .o.........oox@x.oo........xxx@@............ooxxxxo..........ooooxxxxxoxo  
    .x........x@xxo...............o@xxo........oxxx@@@xoooooooooooooooxxxo...  
    .o......ox@@o..................oox@o.....ooxxx@xoooxxxxxxxoooooooooooo.... 
    o..ooooo@@xoooo....ooo...........x@o.....ooxxxxo   .oxxxxxxxxxxooooooo.... 
    . .oooo@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@....ooooox.     .oxx@@@@@xxoo........ 
      .ooooxxxxxxxooooooxooooooooooooooxo...oooooxx.        ..ox@xxxoo.........
      .ooooooxxxx@xoooooooooooooxxoooooooooooxxxxx.            .oxxooooooooxxo.
     .oooooxxxxx@@@xxxxxxxxxxxxxxxxxxxxxxxxoxxxxo.                .oxxxxxxxxo. 
   ....oooxxxxx@@@xo..oxxx@@@@@@xxxxoxxoooooooxx.                  .oxxxoo..   
  .....ooxxxx@@xo.       ........    .ooooooooxxo                              
  ..oooxxxx@@@o                       .oooooooxoo.                             
  ....oxooxxxxx.                       .ooo..oooo.                             
  .....o.ooxxxxxo.                     .oooooooxo.                             
 ......ooooxxxxxxo.                     .ooooooxoo..                           
........ooxxxxxxxo..                     .o....oxoo...                         
.......ooooxxxxxxxo.                     ........oooo.                         
.ooooooo..ooxxxxoooo.                    .........ooo...                       
..oxo...ooooxxxoooo..                    .ooo......oooo...                     
  .ooooo....o.                            .oxxxoo....ooo....                   
    .oooooo...                              ...ooooo...ooo..                   
       ...                                     .oo.......                      
                                               ....ooo...                      
                      __              __                                       
 ______              [  |            [  |                 ._____  _          _ 
|_   _ \              | |  _          | |                /  ___ \| |        | |
  | |_) | .---.  _. _.| | / |  .---.  | | .---.  _    _ / /    \_|\ \  /\  / / 
  |  __'./ /__\\[ /`\_| '' <  / /__\\ | |/ /__\\| \  | | |   _____ \ \/  \/ /  
 _| |__| | \__. | |   | |`\ \ | \___. | || \___. \ \/ / \ \.___| |  \  /\  /   
|_______/ \.__./[_]  [__|  \_] \.__./[___]\.__./  \  /   \.____./    \/  \/    
                                                  / /                          
                                                 /_/                           
 --------------------------------------------------------------------------------
 Please cite the main BerkeleyGW paper when using results from this calculation:

 Jack Deslippe, Georgy Samsonidze, David A. Strubbe, Manish Jain, Marvin L.
 Cohen, and Steven G. Louie, "BerkeleyGW: A Massively Parallel Computer Package
 for the Calculation of the Quasiparticle and Optical Properties of Materials
 and Nanostructures," Comput. Phys. Commun. 183, 1269 (2012)

 Aditionally, PLEASE CITE ALL PAPERS REPORTED AT THE END OF THIS CALCULATION.
 --------------------------------------------------------------------------------

 Running MPI version (parallel)
 Running with 320 MPI task(s)
 Using OpenMP. Number of threads per MPI task: 2

 Compilation flags:
 - Compiler: GNU
 - Para. flags: MPI, OMP
 - Math  flags: USESCALAPACK, UNPACKED, USEFFTW3, HDF5
 - Debug flags: 

 Running with verbosity level 1 (default).

 Kernel was calculated only for (v,c)->(v',c') transitions.
 This may not be a good idea for metals!

 The restricted fi/co WFN transformation dvv',dcc' will be calculated.

 Using the Tamm-Dancoff approximation.

 Using the velocity operator

 Using the Delaunay interpolation method.

 We are doing a calculation with zero exciton momentum
 Running with semiconductor screening

 We are communicating via MPI

 We are using a truncated Coulomb interaction: cell slab
 Cutoff for Monte-Carlo average of Coulomb potential: 1.000E-012 Ry


 Number of k-points in the coarse k-grid: 9
 A 2-D interpolation algorithm will be employed.
 No symmetries used in the fine grid-sampling
 K-grid: 8 8 1
 Highest occupied band (fine grid) = 36
 Valence max    (fine grid) = 3.590679 eV
 Conduction min (fine grid) = 4.602156 eV
 Middle energy  (fine grid) = 4.096417 eV
 Fermi  energy  (fine grid) = 4.096417 eV

 Number of electrons per unit cell (from ifmax) = 72.000000
 Number of electrons per unit cell (from occupations) = 72.000000
 Plasma Frequency = 1.538875 Ry


 Scissors parameters:
 - Valence:    es =   0.0000 eV, e0 =   0.0000 eV, edel =   0.0000
 - Conduction: es =   0.0000 eV, e0 =   0.0000 eV, edel =   0.0000

 You are doing a class 3 calculation - npes > nk*nc

 Memory available: 15367.0 MB per PE
 Memory required for vcoul: 114.4 MB per PE
 Memory needed to store the effective Ham. and intkernel arrays: .6 MB per PE
 Additional memory needed for evecs and diagonalization: .5 MB per PE

 Distribution of kcv blocks among PE ranks:
   - PEs 0 to 127 : 3 blocks
   - PEs 128 to 319 : 2 blocks

 Started reading wavefunctions (WFN_fi) with 64 k-point(s) at 06:28:16.
 [ 06:28:16 |   0% ] k-point  1 / 64.
 [ 06:28:16 |   3% ] k-point  3 / 64, remaining: 1 s.
 [ 06:28:16 |   9% ] k-point  7 / 64, remaining: 1 s.
 [ 06:28:16 |  19% ] k-point 13 / 64, remaining: 1 s.
 [ 06:28:16 |  30% ] k-point 20 / 64, remaining: 1 s.
 [ 06:28:17 |  39% ] k-point 26 / 64, remaining: 1 s.
 [ 06:28:17 |  50% ] k-point 33 / 64, remaining: 0 s.
 [ 06:28:17 |  59% ] k-point 39 / 64, remaining: 0 s.
 [ 06:28:17 |  69% ] k-point 45 / 64, remaining: 0 s.
 [ 06:28:17 |  80% ] k-point 52 / 64, remaining: 0 s.
 [ 06:28:17 |  89% ] k-point 58 / 64, remaining: 0 s.
 Finished reading wavefunctions (WFN_fi) at 06:28:17.
 Elapsed time: 1 s.


 Conduction wavefunctions read from file WFN_fi:
 - Number of k-points in irreducible BZ: 64
 - Number of k-points in full BZ: 64

 Lowest-energy independent-particle transitions:

                k-point                 ik     ic     iv     energy (eV)
   -------------------------------- ------ ------ ------ ---------------
    -0.316250  -0.328750   0.000000     46      1      1        1.011477
     0.308750   0.296250   0.000000     19      1      1        1.239544
     0.308750  -0.578750   0.000000     20      1      1        1.479990
    -0.566250   0.296250   0.000000     27      1      1        1.586291
    -0.316250  -0.328750   0.000000     46      1      2        1.637326

 More job parameters:
 - Crystal volume (bohr): 9.781E+04
 - Broadening (eV): .150
 - Number of valence bands: 3
 - Number of cond. bands: 4
 - Number of spins: 1
 - Number of eigenvalues to be computed: 768

 Highest occupied band (fine grid) = 36
 Shift vector :   0.00125  0.00125  0.00000  Length = 0.00257

WARNING: There are only valence bands present; cannot determine Fermi energy.
 No symmetries used in the shifted-grid sampling

 Started reading wavefunctions (WFNq_fi) with 64 k-point(s) at 06:28:17.
 [ 06:28:17 |   0% ] k-point  1 / 64.
 [ 06:28:17 |   3% ] k-point  3 / 64, remaining: 1 s.
 [ 06:28:17 |   9% ] k-point  7 / 64, remaining: 1 s.
 [ 06:28:17 |  19% ] k-point 13 / 64, remaining: 1 s.
 [ 06:28:17 |  30% ] k-point 20 / 64, remaining: 1 s.
 [ 06:28:17 |  39% ] k-point 26 / 64, remaining: 0 s.
 [ 06:28:17 |  50% ] k-point 33 / 64, remaining: 0 s.
 [ 06:28:18 |  59% ] k-point 39 / 64, remaining: 0 s.
 [ 06:28:18 |  69% ] k-point 45 / 64, remaining: 0 s.
 [ 06:28:18 |  80% ] k-point 52 / 64, remaining: 0 s.
 [ 06:28:18 |  89% ] k-point 58 / 64, remaining: 0 s.
 Finished reading wavefunctions (WFNq_fi) at 06:28:18.
 Elapsed time: 1 s.


 Valence wavefunctions read from file WFNq_fi:
 - Number of k-points in irreducible BZ: 64
 - Number of k-points in full BZ: 64

 Reading quasiparticle energy corrections from eqp_co.dat
 Highest occupied band (coarse grid) = 36
 Valence max    (coarse grid) = 1.434607 eV
 Conduction min (coarse grid) = 4.317300 eV
 Middle energy  (coarse grid) = 2.875954 eV
 Fermi  energy  (coarse grid) = 2.875954 eV


 Reading quasiparticle energy corrections from eqp_co.dat
WARNING: Selected number of valence bands breaks degenerate subspace in WFN_co. Run degeneracy_check.x for allowable numbers.

 Using symmetries to expand the coarse-grid sampling

 Started reading wavefunctions (WFN_co) with 4 k-point(s) at 06:28:18.
 [ 06:28:18 |   0% ] k-point 1 / 4.
 [ 06:28:18 |  25% ] k-point 2 / 4.
 [ 06:28:18 |  50% ] k-point 3 / 4, remaining: 0 s.
 [ 06:28:18 |  75% ] k-point 4 / 4, remaining: 0 s.
 Finished reading wavefunctions (WFN_co) at 06:28:18.
 Elapsed time: 0 s.


 Coarse-grid wavefunctions read from file WFN_co:
 - Number of k-points in irreducible BZ: 4
 - Number of k-points in full BZ: 9

 Started wavefunction interpolation with 1 k-point(s) at 06:28:18.
 [ 06:28:18 |   0% ] k-point 1 / 1.
 Finished wavefunction interpolation at 06:28:18.
 Elapsed time: 0 s.

 Max. error in norm of transformation coefficients (1 - \sum_co |d_fi,co|^2):
  - For valence states: 6.903E-01
  - For conduction states: 7.915E-01

WARNING: there are fine/coarse transformation coefficients with 2-norm < 50%.
Most likely, you are including the same number of bands in the coarse grid
as in the fine grid, or your coarse k-grid is too coarse. You should always
include more bands in the coarse grid to capture, for instance, band crossings.
To improve convergence, you might want to consider:
- including more bands from the coarse WFN_co file (number_*_bands_coarse)
- decreasing the number of bands from the fine WFN_fi file (number_*_bands_fine)
- using a coarse WFN_co file with a denser k-mesh
- recalculating the kernel using the "extended_kernel" flag (if metal)
- using the "unrestricted_transformation" flag in the input file (if metal)

 Writing matrix elements into vmtxel

 Plasma Frequency :    20.937461751051192       eV

 Polarization:   0.001250   0.001250   0.000000
 Sum rule (DFT) :    6.6037538535867857E-002
 Sum rule (GW)  :   0.11163028957926445     


 Epsilon matrix for q->0 read from eps0mat.h5:
 - Number of q-points: 1
 - Dielectric cutoff (Ry): 9.00

 Epsilon matrix for q/=0 read from epsmat.h5:
 - Number of q-points: 3
 - Number of q-points in the full BZ: 9
 - Dielectric cutoff (Ry): 9.00
 - Number of G-vectors for interpolation of epsinv_00(q+G): 176313
 - Maximum value of imaginary part of epsinv: .000000
 - Dielectric constant: 1.252694
 - Max. |q+G|^2 to interp. epsinv (Ry): 2.11
 - Number of q+G points to interp. epsinv: 55

 Assembling spin-singlet kernel.
 Calculating Coulomb potential v(q) for 64 q-points.
 Performing kernel interpolation.

 Started interpolating BSE kernel with 12 block(s) at 06:28:20.
 [ 06:28:20 |   0% ] block  1 / 12.
 [ 06:28:20 |   8% ] block  2 / 12.
 [ 06:28:20 |  17% ] block  3 / 12, remaining: 0 s.
 [ 06:28:20 |  25% ] block  4 / 12, remaining: 0 s.
 [ 06:28:20 |  33% ] block  5 / 12, remaining: 0 s.
 [ 06:28:20 |  42% ] block  6 / 12, remaining: 0 s.
 [ 06:28:20 |  58% ] block  8 / 12, remaining: 0 s.
 [ 06:28:20 |  67% ] block  9 / 12, remaining: 0 s.
 [ 06:28:20 |  75% ] block 10 / 12, remaining: 0 s.
 [ 06:28:20 |  83% ] block 11 / 12, remaining: 0 s.
 [ 06:28:20 |  92% ] block 12 / 12, remaining: 0 s.
 Finished interpolating BSE kernel at 06:28:20.
 Elapsed time: 0 s.


 BLACS processor grid: 17 x 18; BLOCKSIZE = 64
 Number of idle processors: 14

 Using diagonalization routine: PZHEEVX
 Beginning ScaLAPACK diagonalization. Size: 768
 Done ScaLAPACK diagonalization
 Sharing eigenvectors
 Diagonalization done

 Plasma Frequency :    20.937461751051192       eV

 Polarization:   0.001250   0.001250   0.000000
 Sum rule (BSE) :    7.9663563291832634E-002

********************************************************************************
*                                                                              *
* Your calculation employed methods and algorithms published in peer-reviewed  *
* papers. Please, cite the following references to give proper credit to their *
*          authors and help support future development of BerkeleyGW.          *
*                                                                              *
********************************************************************************

 J. Deslippe, G. Samsonidze, D. A. Strubbe, M. Jain, M. L. Cohen, and S. G.
 Louie, BerkeleyGW: A Massively Parallel Computer Package for the Calculation
 of the Quasiparticle and Optical Properties of Materials and Nanostructures,
 Computer Physics Communications 183, 1269 (2012).

 M. Rohlfing and S. G. Louie, Electron-Hole Excitations and Optical Spectra
 from First Principles, Phys. Rev. B 62, 4927 (2000).

 S. Ismail-Beigi, Truncation of Periodic Image Interactions for Confined
 Systems, Phys. Rev. B 73, 233103 (2006).

********************************************************************************

 
 Timing information
 
                                CPU time (s)          WALL time (s)       Number
 Routine                       min        max        min        max     of calls
 -------------------------  ---------  ---------  ---------  ---------  --------
 - Input                         0.80       0.92       0.92       0.92         1
 - Input q                       0.55       0.78       0.78       0.78         1
 - Intwfn                        1.27       1.32       1.30       1.31         1
 - Intkernel                     1.14       1.16       1.16       1.16         1
 - Epsdiag                       0.00       0.03      -0.00       0.05         1
 - Eps Comm                      0.00       0.05      -0.00       0.05         1
 - Absorp0                       0.00       0.05       0.00       0.03         1
 - Vmtxel                        0.03       0.03       0.03       0.03         1
 - Trans Mtxel                   0.00       0.00       0.00       0.00         1
 - Absorp                        0.00       0.02       0.00       0.02         1
 - Write Eig                     0.03       0.07       0.05       0.07         1
 - Iw Input_co                   0.19       0.20       0.19       0.20         1
 - Iw Interp                     0.00       0.02       0.00       0.02         2
 - Iw Genwf                      0.00       0.00       0.00       0.00         6
 - Iw Gwnwf_Co                   0.42       0.49       0.43       0.48         3
 - Iw Mtxel_t                    0.00       0.00       0.00       0.00         6
 - Iw Write                      0.00       0.05       0.00       0.05         1
 - Iw Reduce                     0.00       0.00       0.00       0.00         1
 - Ik Setup                      0.00       0.00      -0.00       0.00         1
 - Ik C-Check                    0.02       0.03       0.02       0.04         1
 - Ik Input                      0.02       0.03       0.01       0.03        36
 - Ik Inteps                     0.00       0.00      -0.00       0.00         1
 - Ik Vcoul                      1.05       1.05       1.04       1.05         1
 - Ik Cache                      0.00       0.00       0.00       0.00       768
 - Ik Interp                     0.00       0.01       0.00       0.01       768
 - Ik Sum                        0.00       0.00       0.00       0.00       768
 - Diagonalize                   0.27       0.50       0.35       0.35         1
 - TOTAL                         4.42       4.80       4.64       4.64         1
 
 Job Done
 
